<div class="dashboard-container">
  <h2 class="page-title">Investment Dashboard</h2>

  <!-- Add Investment Form -->
  <form (ngSubmit)="addInvestment()" class="form-section">
    <mat-card class="form-card">
      <div class="form-grid">
        <mat-form-field appearance="outline">
          <mat-label>Asset Name</mat-label>
          <input matInput [(ngModel)]="asset_name" name="asset_name" required>
        </mat-form-field>

        <mat-form-field appearance="outline">
          <mat-label>Asset Type</mat-label>
          <input matInput [(ngModel)]="asset_type" name="asset_type" required>
        </mat-form-field>

        <mat-form-field appearance="outline">
          <mat-label>Units</mat-label>
          <input matInput type="number" [(ngModel)]="units" name="units" required>
        </mat-form-field>

        <mat-form-field appearance="outline">
          <mat-label>Purchase Price</mat-label>
          <input matInput type="number" [(ngModel)]="purchase_price" name="purchase_price" required>
        </mat-form-field>

        <mat-form-field appearance="outline">
          <mat-label>Current Price</mat-label>
          <input matInput type="number" [(ngModel)]="current_price" name="current_price" required>
        </mat-form-field>
      </div>

      <div class="form-actions">
        <button mat-raised-button color="primary" type="submit">Add Investment</button>
      </div>

      <p class="status-message">{{ message }}</p>
    </mat-card>
  </form>

  <!-- Investments Table -->
  <mat-card *ngIf="investments.length > 0" class="table-card">
    <h3>Your Investments</h3>
    <table mat-table [dataSource]="investments" class="mat-elevation-z2 styled-table">

      <ng-container matColumnDef="asset_name">
        <th mat-header-cell *matHeaderCellDef>Asset Name</th>
        <td mat-cell *matCellDef="let inv">{{ inv.asset_name }}</td>
      </ng-container>

      <ng-container matColumnDef="asset_type">
        <th mat-header-cell *matHeaderCellDef>Type</th>
        <td mat-cell *matCellDef="let inv">{{ inv.asset_type }}</td>
      </ng-container>

      <ng-container matColumnDef="units">
        <th mat-header-cell *matHeaderCellDef>Units</th>
        <td mat-cell *matCellDef="let inv">{{ inv.units }}</td>
      </ng-container>

      <ng-container matColumnDef="purchase_price">
        <th mat-header-cell *matHeaderCellDef>Purchase</th>
        <td mat-cell *matCellDef="let inv">₹{{ inv.purchase_price }}</td>
      </ng-container>

      <ng-container matColumnDef="current_price">
        <th mat-header-cell *matHeaderCellDef>Current</th>
        <td mat-cell *matCellDef="let inv">₹{{ inv.current_price }}</td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="['asset_name', 'asset_type', 'units', 'purchase_price', 'current_price']"></tr>
      <tr mat-row *matRowDef="let row; columns: ['asset_name', 'asset_type', 'units', 'purchase_price', 'current_price'];"></tr>
    </table>
  </mat-card>

  <!-- Analytics Section -->
  <div *ngIf="analytics" class="analytics-section">
    <mat-card class="analytics-card">
      <h3>Portfolio Analytics</h3>
      <p><b>Total Value:</b> ₹{{ analytics.total_value }}</p>
      <p><b>Gain/Loss:</b> {{ analytics.gain_loss_percent }}%</p>
      <p><b>Volatility:</b> {{ analytics.volatility }}</p>
      <p><b>Risk:</b> {{ analytics.risk }}</p>
    </mat-card>

    <mat-card class="chart-card">
      <apx-chart
        [series]="chartOptions.series"
        [chart]="chartOptions.chart"
        [labels]="chartOptions.labels"
        [responsive]="chartOptions.responsive"
        [legend]="chartOptions.legend">
      </apx-chart>
    </mat-card>
  </div>

  <div class="logout-section">
    <button mat-raised-button color="warn" (click)="logout()">Logout</button>
  </div>
</div>
